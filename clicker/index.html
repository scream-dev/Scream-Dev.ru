<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–ª–∏–∫–µ—Ä</title>
    <link rel="icon" href="icon.png" type="image/png"> <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ —Å–∞–π—Ç–∞ -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap" rel="stylesheet">
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #f0f8ff;
            font-family: 'Roboto', sans-serif;
            margin: 0;
        }
        h1 {
            margin-bottom: 20px;
            font-size: 36px;
            color: #333;
        }
        #click-button {
            background-color: #4CAF50; /* –ó–µ–ª–µ–Ω—ã–π */
            color: white;
            border: none;
            border-radius: 50%; /* –ö—Ä—É–≥–ª–∞—è –∫–Ω–æ–ø–∫–∞ */
            width: 150px; /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∫–Ω–æ–ø–∫–∏ */
            height: 150px; /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∫–Ω–æ–ø–∫–∏ */
            font-size: 32px; /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –∫–Ω–æ–ø–∫–µ */
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 20px;
        }
        #click-button:hover {
            background-color: #45a049; /* –¢–µ–º–Ω–µ–µ –∑–µ–ª–µ–Ω—ã–π */
            transform: scale(1.05);
        }
        #click-button:active {
            transform: scale(0.95);
        }
        #auth {
            position: relative; /* –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è drop-down */
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
        }
        #login-button, #register-button {
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            margin: 5px 0;
        }
        #login-button:hover,
        #register-button:hover {
            background-color: #0056b3;
            transform: scale(1.05);
        }
        #login-dropdown {
            display: none; /* –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–æ */
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            z-index: 1;
            padding: 10px;
        }
        #login-button:focus + #login-dropdown,
        #login-dropdown:hover {
            display: block; /* –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –∏–ª–∏ —Ñ–æ–∫—É—Å–µ –Ω–∞ –∫–Ω–æ–ø–∫–µ */
        }
        input {
            margin: 5px 0;
            padding: 10px;
            width: 180px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button {
            background-color: #007BFF; /* –°–∏–Ω–∏–π */
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
            transition: background-color 0.3s, transform 0.2s;
        }
        button:hover {
            background-color: #0056b3; /* –¢–µ–º–Ω–µ–µ —Å–∏–Ω–∏–π */
            transform: scale(1.05);
        }
        button:active {
            transform: scale(0.95);
        }
        #leaderboard {
            margin-top: 20px;
            max-width: 400px;
            list-style-type: none;
            padding: 0;
        }
        #leaderboard li {
            padding: 10px;
            color: #333;
            font-size: 18px; /* –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –¥–ª—è –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ */
        }
        #leaderboard li.top1:before {
            content: "ü•á "; /* –ú–µ–¥–∞–ª—å –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –º–µ—Å—Ç–∞ */
        }
        #leaderboard li.top2:before {
            content: "ü•à "; /* –ú–µ–¥–∞–ª—å –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –º–µ—Å—Ç–∞ */
        }
        #leaderboard li.top3:before {
            content: "ü•â "; /* –ú–µ–¥–∞–ª—å –¥–ª—è —Ç—Ä–µ—Ç—å–µ–≥–æ –º–µ—Å—Ç–∞ */
        }
        #leaderboard li.other {
            /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –±–µ–∑ –º–µ–¥–∞–ª–∏ */
        }
        #current-user {
            margin-top: 20px;
            font-weight: bold;
        }
        #clear-accounts-button {
            background-color: #FF5733; /* –ö—Ä–∞—Å–Ω—ã–π –¥–ª—è –æ–ø–∞—Å–Ω–æ–π –∫–Ω–æ–ø–∫–∏ */
            margin-top: 20px;
        }
    </style>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-analytics.js";
        import { getDatabase, ref, set, onValue, remove } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-database.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAztsNLVs9nElrvQtCZQA2ZF-jCUuPasZc",
            authDomain: "screamdev-ca68a.firebaseapp.com",
            databaseURL: "https://screamdev-ca68a-default-rtdb.firebaseio.com",
            projectId: "screamdev-ca68a",
            storageBucket: "screamdev-ca68a.firebasestorage.app",
            messagingSenderId: "513024079698",
            appId: "1:513024079698:web:912302891a5927df61ac8b",
            measurementId: "G-W1N63CWZX9"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const database = getDatabase(app);
        const auth = getAuth(app);

        const clickButton = document.getElementById('click-button');
        const leaderboardElement = document.getElementById('leaderboard');
        const usernameInput = document.getElementById('username');
        const loginButton = document.getElementById('login-button');
        const registerButton = document.getElementById('register-button');
        const logoutButton = document.getElementById('logout-button');
        const currentUserElement = document.getElementById('current-user');
        const clearAccountsButton = document.getElementById('clear-accounts-button');

        let currentUserId = null;

        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        onAuthStateChanged(auth, user => {
            if (user) {
                currentUserId = user.displayName; // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
                currentUserElement.textContent = `–ü—Ä–∏–≤–µ—Ç, ${currentUserId}`;
                logoutButton.style.display = 'block';
            } else {
                currentUserId = null;
                currentUserElement.textContent = '';
                logoutButton.style.display = 'none';
            }
            updateLeaderboard();
        });

        loginButton.addEventListener('click', () => {
            const username = usernameInput.value;

            if (!username) {
                alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.");
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
            const userRef = ref(database, `users/${username}`);
            onValue(userRef, (snapshot) => {
                if (snapshot.exists()) {
                    currentUserId = username;
                    currentUserElement.textContent = `–ü—Ä–∏–≤–µ—Ç, ${currentUserId}`;
                    logoutButton.style.display = 'block';
                    updateLeaderboard();
                } else {
                    alert("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å, –µ—Å–ª–∏ –≤—ã –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.");
                }
            });
        });

        registerButton.addEventListener('click', () => {
            const username = usernameInput.value;

            if (!username) {
                alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.");
                return;
            }

            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
            const userRef = ref(database, `users/${username}`);
            set(userRef, { clicks: 0 })
                .then(() => {
                    alert("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!");
                })
                .catch(error => {
                    alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: " + error.message);
                });
        });

        logoutButton.addEventListener('click', () => {
            currentUserId = null;
            currentUserElement.textContent = '';
            logoutButton.style.display = 'none';
            updateLeaderboard();
        });

        clickButton.addEventListener('click', () => {
            if (!currentUserId) {
                alert("–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç.");
                return;
            }

            const userRef = ref(database, `users/${currentUserId}/clicks`);
            onValue(userRef, (snapshot) => {
                const clicks = snapshot.val() || 0;
                set(userRef, clicks + 1);
            });
        });

        clearAccountsButton.addEventListener('click', () => {
            if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!")) {
                remove(ref(database, 'users')).then(() => {
                    alert("–í—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã –±—ã–ª–∏ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã.");
                }).catch(error => {
                    alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤: " + error.message);
                });
            }
        });

        function updateLeaderboard() {
            onValue(ref(database, 'users'), (snapshot) => {
                const users = snapshot.val();
                leaderboardElement.innerHTML = '';

                if (users) {
                    const leaderboardArray = Object.entries(users).map(([id, userData]) => ({
                        id,
                        clicks: userData.clicks || 0
                    }));

                    leaderboardArray.sort((a, b) => b.clicks - a.clicks);

                    leaderboardArray.forEach((user, index) => {
                        const listItem = document.createElement('li');
                        listItem.textContent = `${index + 1}. ${user.id} - ${user.clicks}`; // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞

                        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–Ω—ã–µ CSS –∫–ª–∞—Å—Å—ã –¥–ª—è –ø–µ—Ä–≤—ã—Ö —Ç—Ä–µ—Ö –º–µ—Å—Ç
                        if (index < 3) listItem.className = "top" + (index + 1);
                        else listItem.className = "other";

                        leaderboardElement.appendChild(listItem);
                    });
                }
            });
        }
    </script>
</head>
<body>
    <h1>–ö–ª–∏–∫–µ—Ä</h1>
    <div id="auth">
        <button id="login-button">–í–æ–π—Ç–∏</button>
        <div id="login-dropdown">
            <input type="text" id="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" />
            <button id="register-button">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            <button id="logout-button" style="display:none;">–í—ã–π—Ç–∏</button>
        </div>
    </div>
    <button id="click-button">–ö–ª–∏–∫–Ω–∏!</button>
    <button id="clear-accounts-button">–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã</button>
    <h2>–õ–∏–¥–µ—Ä–±–æ—Ä–¥</h2>
    <ul id="leaderboard"></ul>
    <div id="current-user"></div>
</body>
</html>
